<!DOCTYPE html><html class="hide-aside" lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Modeling the global geomagnetic field | 银海里泛摘天星</title><meta name="keywords" content="地球磁场,反演,南大西洋磁异常"><meta name="author" content="Tabris Trees Severus"><meta name="copyright" content="Tabris Trees Severus"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Advanced Earth electromagnetism Homework-3Build an internal geomagnetic using observatory data  Wu Xianshu 12132710  Methods and dataAccording to the Gauss Theory of geomagnetism, we can use the spher">
<meta property="og:type" content="article">
<meta property="og:title" content="Modeling the global geomagnetic field">
<meta property="og:url" content="http://tabirstrees.top/2022/06/18/globalmagnetic/index.html">
<meta property="og:site_name" content="银海里泛摘天星">
<meta property="og:description" content="Advanced Earth electromagnetism Homework-3Build an internal geomagnetic using observatory data  Wu Xianshu 12132710  Methods and dataAccording to the Gauss Theory of geomagnetism, we can use the spher">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-20220618211907.png">
<meta property="article:published_time" content="2022-06-18T13:00:02.000Z">
<meta property="article:modified_time" content="2022-06-18T13:37:11.907Z">
<meta property="article:author" content="Tabris Trees Severus">
<meta property="article:tag" content="地球磁场">
<meta property="article:tag" content="反演">
<meta property="article:tag" content="南大西洋磁异常">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-20220618211907.png"><link rel="shortcut icon" href="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/1.png"><link rel="canonical" href="http://tabirstrees.top/2022/06/18/globalmagnetic/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-166333226-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-166333226-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":200,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Modeling the global geomagnetic field',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-18 21:37:11'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/20200429094050.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 分享(构建中...)</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 朋友</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.link"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-20220618211907.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">银海里泛摘天星</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 分享(构建中...)</span><i class="fas fa-chevron-down expand hide"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 朋友</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.link"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Modeling the global geomagnetic field</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-18T13:00:02.000Z" title="发表于 2022-06-18 21:00:02">2022-06-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-06-18T13:37:11.907Z" title="更新于 2022-06-18 21:37:11">2022-06-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%A7%91%E7%A0%94/">科研</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%A7%91%E7%A0%94/%E5%9C%B0%E7%90%83%E7%A3%81%E5%9C%BA/">地球磁场</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Modeling the global geomagnetic field"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Advanced-Earth-electromagnetism-Homework-3"><a href="#Advanced-Earth-electromagnetism-Homework-3" class="headerlink" title="Advanced Earth electromagnetism Homework-3"></a>Advanced Earth electromagnetism Homework-3</h1><center><span style='font-size: 20px;font-weight:bold'>Build an internal geomagnetic using observatory data</span></center>

<center><div style='height:2mm;'></div><div style='font-family:华文楷体;font-size:14pt;'>Wu Xianshu 12132710</div></center>

<h2 id="Methods-and-data"><a href="#Methods-and-data" class="headerlink" title="Methods and data"></a>Methods and data</h2><p>According to the Gauss Theory of geomagnetism, we can use the spherical harmonic analysis to describe the earth’s main magnetic field. Suppose the magnetic potential of the geomagnetic field obeys Laplace’s equation at the surface of the Earth as well as outside of the Earth, the model can be written as:</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{aligned}
        V(r,\theta,\phi)=a \sum_{n=1}^{N} \sum_{m=0}^{n}\left(g_{n}^{m} \cos m \phi+h_{n}^{m} \sin m \phi\right)\left(\frac{a}{r}\right)^{n+1} P_{n}^{m}(\cos \theta)
    \end{aligned}
\end{equation}</script><script type="math/tex; mode=display">
\begin{equation}
    \begin{aligned}
        X&=\sum_{n=1}^{N} \sum_{m=0}^{n}\left(\frac{a}{r}\right)^{n+2}\left(g_{n}^{m} \cos m \phi+h_{n}^{m} \sin m \phi\right) \frac{d}{d \theta} p_{n}^{m}(\cos \theta) \\
        Y&=\sum_{n=1}^{N} \sum_{m=0}^{n} \frac{-m}{\sin \theta}\left(\frac{a}{r}\right)^{n+2}\left(-g_{n}^{m} \sin m \phi+h_{n}^{m} \cos m \phi\right) p_{m}^{m}(\cos \theta) \\
        Z&=\sum_{n=0}^{N} \sum_{m=0}^{n}-(n+1)\left(\frac{a}{r}\right)^{n+2}\left(g_{n}^{m} \cos m \phi+h_{n}^{m} \sin m \phi\right) p_{n}^{m}(\cos \theta)
    \end{aligned}
\end{equation}</script><p>The only uncertainty in the formula is $g_n^m$ and $h_n^m$, which called Gauss Coefficient, and when we have the model and the data, we can get the parameters value by inversion methods. The problem becomes solving the following system of linear algebraic equations (the observations are taken at a spherical surface of the Earth’s mean radius, $r=a$ ):</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{aligned}
        \mathbf{A}\mathbf{m}=\mathbf{d}
    \end{aligned}
\end{equation}</script><script type="math/tex; mode=display">
\begin{aligned}
    \mathbf{A} = \left[ \begin{array}{c}
        \vdots & \vdots & \vdots & \vdots \\ \cdots & \cos(m\phi_i)\frac{\mathrm{d} P_n^m(\cos\theta_i)}{\mathrm{d}\theta_i} & \sin(m\phi_i)\frac{\mathrm{d} P_n^m(\cos\theta_i)}{\mathrm{d}\theta_i} & \cdots \\
        \cdots & m \sin(m\phi_i)\frac{P_n^m(\cos\theta_i)}{\sin\theta_i} & -m \cos(m\phi_i)\frac{P_n^m(\cos\theta_i)}{\sin\theta_i} & \cdots \\
        \cdots & -\cos(m\phi_i)P_n^m(\cos\theta_i)(n+1) & -\sin(m\phi_i)P_n^m(\cos\theta_i)(n+1) & \cdots \\
        \vdots & \vdots & \vdots & \vdots 
    \end{array} \right];
\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
    \mathbf{m} = \left[ \begin{array}{c}
        g_1^0 \\ \vdots \\ g_n^{n-1} \\ g_n^n \\h_n^1 \\ h_n^2 \\ \vdots \\ h_N^N
    \end{array} \right];\ \mathbf{d} = \left[ \begin{array}{c}
        \vdots \\ X_i \\ Y_i \\ Z_i \\ \vdots
    \end{array} \right];\ \frac{\mathrm{d}P_n^m(\cos\theta)}{\mathrm{d}\theta} = \frac{\left(n \cos \theta P_{n}^{m}-R_{n}^{m} P_{n-1}^{m}\right)}{\sin \theta};
\end{aligned}</script><p>The data in $\mathbf{d}$ are download from <strong>INTERMAGNET</strong>, the website is <a target="_blank" rel="noopener" href="https://www.intermagnet.org/data-donnee/download-eng.php">https://www.intermagnet.org/data-donnee/download-eng.php</a>. I selected the definitive minute data on 2020-03-05 (Table <a href="#t1">1</a>), all available observation stations are included, Figure <a href="#f1">1</a> is a map showing the observatories I used. the 24-hour data of each station are averaged to obtain the observed values of the day, after eliminating the outliers. I wrote a MATLAB script to implement the above process, and built a model up to spherical harmonic degree 4.</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-stations.jpg" alt="globalmagnetic-stations"></p>
<center id='f1'><span style='font-weight:bold'>Fig 1. </span>Map showing the observatories I used </center>

<h1 id=""><a href="#" class="headerlink" title=""></a> </h1><p><span style='font-weight:bold' id='t1'>Tab 1. </span>A table of data</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Index</th>
<th>Name</th>
<th>Latitude</th>
<th>Longitude</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
<th>Date</th>
<th>Index</th>
<th>Name</th>
<th>Latitude</th>
<th>Longitude</th>
<th>X</th>
<th>Y</th>
<th>Z</th>
<th>Date</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>abg</td>
<td>18.62</td>
<td>72.87</td>
<td>38255.32861</td>
<td>290.4123611</td>
<td>20393.29507</td>
<td>20200305</td>
<td>42</td>
<td>kdu</td>
<td>-12.686</td>
<td>132.472</td>
<td>35457.00736</td>
<td>1754.704167</td>
<td>-29582.17056</td>
<td>20200305</td>
</tr>
<tr>
<td>2</td>
<td>abk</td>
<td>68.358</td>
<td>18.823</td>
<td>11263.29438</td>
<td>1862.256042</td>
<td>52149.73104</td>
<td>20200305</td>
<td>43</td>
<td>kep</td>
<td>-54.282</td>
<td>323.507</td>
<td>15328.23479</td>
<td>-1902.493542</td>
<td>-22927.075</td>
<td>20200305</td>
</tr>
<tr>
<td>3</td>
<td>aia</td>
<td>-65.25</td>
<td>295.73</td>
<td>19743.62451</td>
<td>5529.188194</td>
<td>-31781.59625</td>
<td>20200305</td>
<td>44</td>
<td>kmh</td>
<td>-26.541</td>
<td>18.11</td>
<td>10625.24368</td>
<td>-3290.684375</td>
<td>-24317.20576</td>
<td>20200305</td>
</tr>
<tr>
<td>4</td>
<td>asp</td>
<td>-23.761</td>
<td>133.883</td>
<td>30118.9534</td>
<td>2384.582361</td>
<td>-43746.81958</td>
<td>20200305</td>
<td>45</td>
<td>kny</td>
<td>31.424</td>
<td>130.88</td>
<td>32523.31208</td>
<td>-3937.392708</td>
<td>33352.49993</td>
<td>20200305</td>
</tr>
<tr>
<td>5</td>
<td>bdv</td>
<td>49.08</td>
<td>14.015</td>
<td>20408.24278</td>
<td>1476.498472</td>
<td>44384.11257</td>
<td>20200305</td>
<td>46</td>
<td>kou</td>
<td>5.21</td>
<td>307.269</td>
<td>26566.90834</td>
<td>-8649.159903</td>
<td>6534.03419</td>
<td>20200305</td>
</tr>
<tr>
<td>6</td>
<td>bel</td>
<td>51.836</td>
<td>20.789</td>
<td>18910.50938</td>
<td>2155.445069</td>
<td>46753.62417</td>
<td>20200305</td>
<td>47</td>
<td>lrm</td>
<td>-22.222</td>
<td>114.101</td>
<td>30377.57938</td>
<td>113.0718056</td>
<td>-43262.77563</td>
<td>20200305</td>
</tr>
<tr>
<td>7</td>
<td>bfo</td>
<td>48.331</td>
<td>8.325</td>
<td>21000.85431</td>
<td>971.8170139</td>
<td>43518.68674</td>
<td>20200305</td>
<td>48</td>
<td>lyc</td>
<td>64.612</td>
<td>18.748</td>
<td>12954.21903</td>
<td>1788.108194</td>
<td>50824.92569</td>
<td>20200305</td>
</tr>
<tr>
<td>8</td>
<td>bmt</td>
<td>40.3</td>
<td>116.2</td>
<td>27901.35056</td>
<td>-4109.268472</td>
<td>47580.71354</td>
<td>20200305</td>
<td>49</td>
<td>mab</td>
<td>50.298</td>
<td>5.683</td>
<td>20026.52454</td>
<td>676.6008535</td>
<td>44643.7574</td>
<td>20200305</td>
</tr>
<tr>
<td>9</td>
<td>box</td>
<td>58.07</td>
<td>38.23</td>
<td>15149.76771</td>
<td>3423.754653</td>
<td>50605.48924</td>
<td>20200305</td>
<td>50</td>
<td>maw</td>
<td>-67.6</td>
<td>62.88</td>
<td>6637.389861</td>
<td>-17331.47576</td>
<td>-45610.43313</td>
<td>20200305</td>
</tr>
<tr>
<td>10</td>
<td>brd</td>
<td>49.87</td>
<td>260.026</td>
<td>15215.71021</td>
<td>1349.588194</td>
<td>54525.18188</td>
<td>20200305</td>
<td>51</td>
<td>mcq</td>
<td>-54.5</td>
<td>158.95</td>
<td>10702.30986</td>
<td>6865.926042</td>
<td>-62729.04792</td>
<td>20200305</td>
</tr>
<tr>
<td>11</td>
<td>brw</td>
<td>71.32</td>
<td>203.38</td>
<td>8896.940417</td>
<td>2040.051944</td>
<td>56567.42097</td>
<td>20200305</td>
<td>52</td>
<td>mea</td>
<td>54.616</td>
<td>246.653</td>
<td>13676.0725</td>
<td>3502.193194</td>
<td>55141.94083</td>
<td>20200305</td>
</tr>
<tr>
<td>12</td>
<td>bsl</td>
<td>30.35</td>
<td>270.364</td>
<td>23897.89611</td>
<td>-534.3659028</td>
<td>40619.165</td>
<td>20200305</td>
<td>53</td>
<td>mmb</td>
<td>43.91</td>
<td>144.189</td>
<td>25860.92479</td>
<td>-4160.602986</td>
<td>42601.24806</td>
<td>20200305</td>
</tr>
<tr>
<td>13</td>
<td>cbb</td>
<td>69.123</td>
<td>254.969</td>
<td>5052.641181</td>
<td>515.9493056</td>
<td>58112.67063</td>
<td>20200305</td>
<td>54</td>
<td>ngk</td>
<td>52.072</td>
<td>12.675</td>
<td>18870.10889</td>
<td>1331.096806</td>
<td>45797.97604</td>
<td>20200305</td>
</tr>
<tr>
<td>14</td>
<td>cki</td>
<td>-12.187</td>
<td>96.834</td>
<td>34897.57944</td>
<td>-1267.207778</td>
<td>-32411.88188</td>
<td>20200305</td>
<td>55</td>
<td>nur</td>
<td>60.508</td>
<td>24.655</td>
<td>14746.53667</td>
<td>2287.914931</td>
<td>50328.62708</td>
<td>20200305</td>
</tr>
<tr>
<td>15</td>
<td>clf</td>
<td>48.025</td>
<td>2.26</td>
<td>21268.24681</td>
<td>374.1634028</td>
<td>43038.32201</td>
<td>20200305</td>
<td>56</td>
<td>nvs</td>
<td>54.85</td>
<td>83.23</td>
<td>15977.18264</td>
<td>2267.85125</td>
<td>57794.77472</td>
<td>20200305</td>
</tr>
<tr>
<td>16</td>
<td>cmo</td>
<td>64.871</td>
<td>212.139</td>
<td>12071.0441</td>
<td>3662.327361</td>
<td>55060.79042</td>
<td>20200305</td>
<td>57</td>
<td>ott</td>
<td>45.403</td>
<td>284.448</td>
<td>18006.06139</td>
<td>-4293.210347</td>
<td>50757.78646</td>
<td>20200305</td>
</tr>
<tr>
<td>17</td>
<td>cnb</td>
<td>-35.314</td>
<td>149.363</td>
<td>23121.84965</td>
<td>5192.365069</td>
<td>-52948.43965</td>
<td>20200305</td>
<td>58</td>
<td>pag</td>
<td>42.515</td>
<td>24.177</td>
<td>23724.57785</td>
<td>2052.341181</td>
<td>41095.60694</td>
<td>20200305</td>
</tr>
<tr>
<td>18</td>
<td>cpl</td>
<td>17.293</td>
<td>78.92</td>
<td>39453.13201</td>
<td>-510.5802778</td>
<td>17435.07875</td>
<td>20200305</td>
<td>59</td>
<td>pet</td>
<td>52.971</td>
<td>158.248</td>
<td>21521.23347</td>
<td>-2453.807986</td>
<td>47410.99722</td>
<td>20200305</td>
</tr>
<tr>
<td>19</td>
<td>csy</td>
<td>-66.28</td>
<td>110.53</td>
<td>-1183.919167</td>
<td>-8905.680139</td>
<td>-63455.59493</td>
<td>20200305</td>
<td>60</td>
<td>pil</td>
<td>-31.667</td>
<td>296.119</td>
<td>18525.13889</td>
<td>-1971.772847</td>
<td>-12926.00313</td>
<td>20200305</td>
</tr>
<tr>
<td>20</td>
<td>cta</td>
<td>-20.09</td>
<td>146.264</td>
<td>31415.04941</td>
<td>4032.899791</td>
<td>-37523.00592</td>
<td>20200305</td>
<td>61</td>
<td>pst</td>
<td>-51.704</td>
<td>302.107</td>
<td>17998.51828</td>
<td>816.7563025</td>
<td>-21589.41492</td>
<td>20200305</td>
</tr>
<tr>
<td>21</td>
<td>dou</td>
<td>50.1</td>
<td>4.599</td>
<td>20166.69694</td>
<td>564.5751389</td>
<td>44377.19028</td>
<td>20200305</td>
<td>62</td>
<td>res</td>
<td>74.69</td>
<td>265.105</td>
<td>2821.225278</td>
<td>-966.5449306</td>
<td>57412.04722</td>
<td>20200305</td>
</tr>
<tr>
<td>22</td>
<td>dur</td>
<td>41.65</td>
<td>14.467</td>
<td>24664.39583</td>
<td>1661.169444</td>
<td>39635.57229</td>
<td>20200305</td>
<td>63</td>
<td>sba</td>
<td>-77.85</td>
<td>166.762</td>
<td>-10322.08271</td>
<td>5515.313542</td>
<td>-65094.66458</td>
<td>20200305</td>
</tr>
<tr>
<td>23</td>
<td>ebr</td>
<td>40.957</td>
<td>0.333</td>
<td>25322.75201</td>
<td>348.5455556</td>
<td>37632.16313</td>
<td>20200305</td>
<td>64</td>
<td>sbl</td>
<td>43.932</td>
<td>299.991</td>
<td>20099.86778</td>
<td>-6159.527222</td>
<td>45830.59819</td>
<td>20200305</td>
</tr>
<tr>
<td>24</td>
<td>frd</td>
<td>38.201</td>
<td>282.63</td>
<td>21211.1253</td>
<td>-3948.038707</td>
<td>45969.93919</td>
<td>20200305</td>
<td>65</td>
<td>sfs</td>
<td>36.667</td>
<td>354.055</td>
<td>27692.98333</td>
<td>-437.525625</td>
<td>33061.71813</td>
<td>20200305</td>
</tr>
<tr>
<td>25</td>
<td>frn</td>
<td>37.091</td>
<td>240.281</td>
<td>22610.76882</td>
<td>5106.934306</td>
<td>41905.74014</td>
<td>20200305</td>
<td>66</td>
<td>she</td>
<td>-15.961</td>
<td>354.253</td>
<td>16010.89917</td>
<td>-3784.684444</td>
<td>-25849.75875</td>
<td>20200305</td>
</tr>
<tr>
<td>26</td>
<td>fur</td>
<td>48.165</td>
<td>11.277</td>
<td>20993.37243</td>
<td>1266.938681</td>
<td>43689.14313</td>
<td>20200305</td>
<td>67</td>
<td>sit</td>
<td>57.058</td>
<td>224.675</td>
<td>15003.98639</td>
<td>5020.095972</td>
<td>52959.09139</td>
<td>20200305</td>
</tr>
<tr>
<td>27</td>
<td>gan</td>
<td>-0.695</td>
<td>73.154</td>
<td>38064.10701</td>
<td>-2720.955278</td>
<td>-12852.37549</td>
<td>20200305</td>
<td>68</td>
<td>sjg</td>
<td>18.111</td>
<td>293.85</td>
<td>26371.23667</td>
<td>-6125.861667</td>
<td>24778.29694</td>
<td>20200305</td>
</tr>
<tr>
<td>28</td>
<td>gck</td>
<td>44.63</td>
<td>20.77</td>
<td>22705.50861</td>
<td>1968.7925</td>
<td>42322.95653</td>
<td>20200305</td>
<td>69</td>
<td>spg</td>
<td>60.542</td>
<td>29.716</td>
<td>14451.77243</td>
<td>2766.171111</td>
<td>50554.4159</td>
<td>20200305</td>
</tr>
<tr>
<td>29</td>
<td>gng</td>
<td>-31.356</td>
<td>115.715</td>
<td>24154.41201</td>
<td>-695.7534028</td>
<td>-52657.5475</td>
<td>20200305</td>
<td>70</td>
<td>spt</td>
<td>39.547</td>
<td>355.651</td>
<td>26157.41243</td>
<td>-212.2654861</td>
<td>35974.31007</td>
<td>20200305</td>
</tr>
<tr>
<td>30</td>
<td>gui</td>
<td>28.321</td>
<td>343.559</td>
<td>27788.94125</td>
<td>-3297.265486</td>
<td>22532.55771</td>
<td>20200305</td>
<td>71</td>
<td>tam</td>
<td>22.792</td>
<td>5.53</td>
<td>33853.35556</td>
<td>317.1153472</td>
<td>17125.37632</td>
<td>20200305</td>
</tr>
<tr>
<td>31</td>
<td>had</td>
<td>50.995</td>
<td>355.516</td>
<td>19815.59375</td>
<td>-487.1833333</td>
<td>44458.94479</td>
<td>20200305</td>
<td>72</td>
<td>tdc</td>
<td>-37.067</td>
<td>347.684</td>
<td>9158.353472</td>
<td>-3520.939514</td>
<td>-22389.23111</td>
<td>20200305</td>
</tr>
<tr>
<td>32</td>
<td>hbk</td>
<td>-25.883</td>
<td>27.707</td>
<td>12484.80071</td>
<td>-4183.221111</td>
<td>-24963.03222</td>
<td>20200305</td>
<td>73</td>
<td>thl</td>
<td>77.47</td>
<td>290.77</td>
<td>3048.201319</td>
<td>-2836.9075</td>
<td>56138.82771</td>
<td>20200305</td>
</tr>
<tr>
<td>33</td>
<td>her</td>
<td>-34.425</td>
<td>19.225</td>
<td>9607.833819</td>
<td>-4713.809861</td>
<td>-22995.42292</td>
<td>20200305</td>
<td>74</td>
<td>thy</td>
<td>46.9</td>
<td>17.893</td>
<td>21518.14722</td>
<td>1798.217431</td>
<td>43480.7241</td>
<td>20200305</td>
</tr>
<tr>
<td>34</td>
<td>hlp</td>
<td>54.603</td>
<td>18.811</td>
<td>17482.39139</td>
<td>1693.542639</td>
<td>47405.90799</td>
<td>20200305</td>
<td>75</td>
<td>tsu</td>
<td>-19.202</td>
<td>17.584</td>
<td>14031.38007</td>
<td>-2157.920833</td>
<td>-25488.01035</td>
<td>20200305</td>
</tr>
<tr>
<td>35</td>
<td>hrb</td>
<td>47.875</td>
<td>18.19</td>
<td>20998.77708</td>
<td>1814.178403</td>
<td>44071.71535</td>
<td>20200305</td>
<td>76</td>
<td>tuc</td>
<td>32.174</td>
<td>249.266</td>
<td>23874.2234</td>
<td>3757.009861</td>
<td>40291.74611</td>
<td>20200305</td>
</tr>
<tr>
<td>36</td>
<td>hyb</td>
<td>17.42</td>
<td>78.55</td>
<td>39586.70764</td>
<td>-409.4116667</td>
<td>18254.32278</td>
<td>20200305</td>
<td>77</td>
<td>ups</td>
<td>59.903</td>
<td>17.353</td>
<td>15093.9141</td>
<td>1687.224931</td>
<td>49301.94847</td>
<td>20200305</td>
</tr>
<tr>
<td>37</td>
<td>iqa</td>
<td>63.756</td>
<td>291.49</td>
<td>8624.755702</td>
<td>-3943.983658</td>
<td>56107.03804</td>
<td>20200305</td>
<td>78</td>
<td>vic</td>
<td>48.517</td>
<td>236.583</td>
<td>18091.75582</td>
<td>5186.817181</td>
<td>49871.91367</td>
<td>20200305</td>
</tr>
<tr>
<td>38</td>
<td>irt</td>
<td>52.17</td>
<td>104.45</td>
<td>18339.39819</td>
<td>-1321.375208</td>
<td>57631.08368</td>
<td>20200305</td>
<td>79</td>
<td>vna</td>
<td>-70.683</td>
<td>351.718</td>
<td>18066.2466</td>
<td>-4484.883403</td>
<td>-33255.14722</td>
<td>20200305</td>
</tr>
<tr>
<td>39</td>
<td>izn</td>
<td>40.5</td>
<td>29.72</td>
<td>25075.98528</td>
<td>2459.532708</td>
<td>40544.37868</td>
<td>20200305</td>
<td>80</td>
<td>vss</td>
<td>-22.4</td>
<td>316.35</td>
<td>16425.94375</td>
<td>-6916.265278</td>
<td>-14993.05438</td>
<td>20200305</td>
</tr>
<tr>
<td>40</td>
<td>jco</td>
<td>70.356</td>
<td>211.201</td>
<td>8698.91</td>
<td>2596.038472</td>
<td>56590.54382</td>
<td>20200305</td>
<td>81</td>
<td>wic</td>
<td>47.928</td>
<td>15.862</td>
<td>21013.83049</td>
<td>1646.833889</td>
<td>43916.92826</td>
<td>20200305</td>
</tr>
<tr>
<td>41</td>
<td>kak</td>
<td>36.232</td>
<td>140.186</td>
<td>29794.62132</td>
<td>-4036.528194</td>
<td>35869.73299</td>
<td>20200305</td>
<td>82</td>
<td>wng</td>
<td>53.725</td>
<td>9.053</td>
<td>18186.19222</td>
<td>1002.707153</td>
<td>46352.84486</td>
<td>20200305</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>The 24 Gaussian coefficients I have calculated are in Table <a href="#t2">2</a></p>
<p><span style='font-weight:bold' id='t2'>Tab 2. </span>Gauss Coefficients my obtained (using quasi-Schmidt normalization)</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Coefficent</th>
<th>Degree(n)</th>
<th>Order(m)</th>
<th>Value</th>
<th>Coefficent</th>
<th>Degree(n)</th>
<th>Order(m)</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>g</td>
<td>1</td>
<td>0</td>
<td>-29017.523</td>
<td>h</td>
<td>3</td>
<td>1</td>
<td>-42.65915408</td>
</tr>
<tr>
<td>g</td>
<td>1</td>
<td>1</td>
<td>-1858.68841</td>
<td>h</td>
<td>3</td>
<td>2</td>
<td>600.217349</td>
</tr>
<tr>
<td>h</td>
<td>1</td>
<td>1</td>
<td>4903.10927</td>
<td>h</td>
<td>3</td>
<td>3</td>
<td>-633.5583365</td>
</tr>
<tr>
<td>g</td>
<td>2</td>
<td>0</td>
<td>-2497.135416</td>
<td>g</td>
<td>4</td>
<td>0</td>
<td>1132.882537</td>
</tr>
<tr>
<td>g</td>
<td>2</td>
<td>1</td>
<td>2617.981296</td>
<td>g</td>
<td>4</td>
<td>1</td>
<td>1296.172272</td>
</tr>
<tr>
<td>g</td>
<td>2</td>
<td>2</td>
<td>2178.890222</td>
<td>g</td>
<td>4</td>
<td>2</td>
<td>-2.933163263</td>
</tr>
<tr>
<td>h</td>
<td>2</td>
<td>1</td>
<td>-3201.763686</td>
<td>g</td>
<td>4</td>
<td>3</td>
<td>-357.3671095</td>
</tr>
<tr>
<td>h</td>
<td>2</td>
<td>2</td>
<td>-923.4214529</td>
<td>g</td>
<td>4</td>
<td>4</td>
<td>120.6542625</td>
</tr>
<tr>
<td>g</td>
<td>3</td>
<td>0</td>
<td>805.1006385</td>
<td>h</td>
<td>4</td>
<td>1</td>
<td>486.9660327</td>
</tr>
<tr>
<td>g</td>
<td>3</td>
<td>1</td>
<td>-2166.619627</td>
<td>h</td>
<td>4</td>
<td>2</td>
<td>-230.1865231</td>
</tr>
<tr>
<td>g</td>
<td>3</td>
<td>2</td>
<td>1281.757376</td>
<td>h</td>
<td>4</td>
<td>3</td>
<td>195.544086</td>
</tr>
<tr>
<td>g</td>
<td>3</td>
<td>3</td>
<td>90.1221627</td>
<td>h</td>
<td>4</td>
<td>4</td>
<td>-207.4272451</td>
</tr>
</tbody>
</table>
</div>
<p>In order to evaluate the fitting effect of the model on the data, the prediction data on the original observation point were obtained by using $\mathbf{E} = \mathbf{A}\mathbf{m}$, and the error between the observation value and the prediction value was calculated, as shown in Figure <a href="#f2">2</a>, <a href="#f3">3</a>:</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-est_obs.jpg" alt="globalmagnetic-est_obs"></p>
<center id='f2'><span style='font-weight:bold'>Fig 2. </span>Maps of observation value and prediction value</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-errors.jpg" alt="globalmagnetic-errors"></p>
<center id='f2'><span style='font-weight:bold'>Fig 3. </span>Maps of errors at each observational stations</center>



<h2 id="Global-model-from-inverse-Gauss-Coefficient"><a href="#Global-model-from-inverse-Gauss-Coefficient" class="headerlink" title="Global model from inverse Gauss Coefficient"></a>Global model from inverse Gauss Coefficient</h2><p>The inverse Gauss coefficient can be used to calculate the global magnetic field distribution, which has been shown in Figure <a href="#f4">4-11</a></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-F-c.jpg" alt="globalmagnetic-F-c"></p>
<center id='f4'><span style='font-weight:bold'>Fig 4. </span>Contour-maps of the total field intensity F</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-Br-c.jpg" alt="globalmagnetic-Br-c"></p>
<center id='f5'><span style='font-weight:bold'>Fig 5. </span>Contour-maps of the radial component Br</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-D-c.jpg" alt="globalmagnetic-D-c"></p>
<center id='f6'><span style='font-weight:bold'>Fig 6. </span>Contour-maps of the Declination D</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-I-c.jpg" alt="globalmagnetic-I-c"></p>
<center id='f7'><span style='font-weight:bold'>Fig 7. </span>Contour-maps of the Inclination I</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-F-p.jpg" alt="globalmagnetic-F-p"></p>
<center id='f8'><span style='font-weight:bold'>Fig 8. </span>Contourf-maps of the total field intensity F</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-f9.jpg" alt="globalmagnetic-f9"></p>
<center id='f9'><span style='font-weight:bold'>Fig 9. </span>Contourf-maps of the radial component Br</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-D-p.jpg" alt="globalmagnetic-D-p"></p>
<center id='f10'><span style='font-weight:bold'>Fig 10. </span>Contourf-maps of the Declination D</center>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-I-p.jpg" alt="globalmagnetic-I-p"></p>
<center id='f11'><span style='font-weight:bold'>Fig 11. </span>Contourf-maps of the Inclination I</center>

<p>It is obvious that the South Atlantic magnetic anomaly is consistent with the known characteristics of the geomagnetic field, indicating that our model can reflect the characteristics of the geomagnetic field to a certain extent.</p>
<h2 id="Comparison-with-IGRF-13"><a href="#Comparison-with-IGRF-13" class="headerlink" title="Comparison with IGRF-13"></a>Comparison with IGRF-13</h2><p>Compute the spectrum in SH degree by:</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{aligned}
        S(n)=(n+1) \sum_{m=0}^{n}\left(g_{n}^{m}\right)^{2}+\left(h_{n}^{m}\right)^{2}
    \end{aligned}
\end{equation}</script><p>and compare them with the results of IGRF-13 (Figure <a href="#f12">12</a>) shown that the inversed Gauss coefficients are in good agreement with IGRF-13 model. The characteristics of the main earth’s magnetic field are almost the same, except for a small deviation when the degree is high.</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-spectrum.jpg" alt="globalmagnetic-spectrum"></p>
<center id='f12'><span style='font-weight:bold'>Fig 12. </span>A plot comparing the spectra of my model with that of IGRF-13</center>



<h2 id="Discussion"><a href="#Discussion" class="headerlink" title="Discussion"></a>Discussion</h2><p>Through the inversion of the observed data, I got 24 Gauss coefficients, and used them to establish the global magnetic field model, draw the magnetic field distribution on the surface of earth. Compared with the IGRF-13 model, it has good consistency, but there are still subtle differences. The reason is that when we sift through the data, the distribution of observation stations is not  well-distributed enough, and we can not achieve uniform distribution on a global scale. Therefore, the inversed model is greatly affected by the local data, even if we increase the degree of the  spherical harmonic coefficient will not help, there will be even greater difference. If our model is to be more accurate, it will need to include satellite data that can orbit the Earth around, which will also take into account the effects of external fields on the geomagnetic field, making the model more accurate.</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>The code can be attained at <a target="_blank" rel="noopener" href="https://github.com/tabris-trees/GMFM">my github repository</a></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1]  聂琳娟, 许智铭. 利用SWARM星群磁测数据反演地球主磁场模型WHU-MM01[J]. 测绘地理信息, 2020, 45(05): 16–19.</p>
<p>[2]  徐文耀, 区加明, 杜爱民. 地磁场全球建模和局域建模[J]. 地球物理学进展, 地球物理学进展, 2011, 26(2): 398–415.</p>
<p>[3]  Monika Korte, Catherine Constable. Continuous global geomagnetic field models for the past 3000 years[J]. Physics of the Earth and Planetary Interiors, 2003, 140(1): 73–89.</p>
<p>[4]  N. W. Peddie. USGS model coefficients for continental U.S. and Hawaii (1985)[J]. Planetary and Space Science, 1992, 40(4): 561.</p>
<p>[5]  An Homage to Gauss and His Model of the Earth’s Magnetic Field[J]. CMS Notes, .</p>
<p>[6]  Davis J. Mathematical Modeling of Earth’s Magnetic Field[J]. .</p>
<p>[7]  白春华, 徐文耀, 康国发. 地球主磁场模型[J]. 地球物理学进展, 2008(4): 1045–1057.</p>
<p>[8]  冯春. Matlab实现IGRF国际地磁参考场模型的计算[J]. 内蒙古石油化工, 2014, 40(12): 43–46.</p>
<p>[9]  安振昌. 地磁场区域模型与全球模型的比较和讨论[J]. 物探与化探, 1991(04): 248–254.</p>
<p>[10] 刘元元, 王仕成, 张金生, 等. 最新国际地磁参考场模型IGRF11研究[J]. 地震学报, 2013, 35(1): 125-131+133-134+138.</p>
<p>[11] International Geomagnetic Reference Field (IGRF-13)[EB/OL]. /2022-05-28. <a target="_blank" rel="noopener" href="https://wdc.kugi.kyoto-u.ac.jp/igrf/index.html">https://wdc.kugi.kyoto-u.ac.jp/igrf/index.html</a>.</p>
<p>[12] Alken P, Thébault E, Beggan C D, 等. International Geomagnetic Reference Field: the thirteenth generation[J]. Earth, Planets and Space, 2021, 73(1): 49.</p>
<p>[13]  Finlay C C, Kloss C, Olsen N, 等. The CHAOS-7 geomagnetic field model and observed changes in the South Atlantic Anomaly[J]. Earth, Planets and Space, 2020, 72(1): 156.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Tabris Trees Severus</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://tabirstrees.top/2022/06/18/globalmagnetic/">http://tabirstrees.top/2022/06/18/globalmagnetic/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://tabirstrees.top" target="_blank">银海里泛摘天星</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%9C%B0%E7%90%83%E7%A3%81%E5%9C%BA/">地球磁场</a><a class="post-meta__tags" href="/tags/%E5%8F%8D%E6%BC%94/">反演</a><a class="post-meta__tags" href="/tags/%E5%8D%97%E5%A4%A7%E8%A5%BF%E6%B4%8B%E7%A3%81%E5%BC%82%E5%B8%B8/">南大西洋磁异常</a></div><div class="post_share"><div class="social-share" data-image="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/globalmagnetic-20220618211907.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/07/08/KappaDistribution/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://hexo-1301133429.cos.ap-chengdu.myqcloud.com/post/4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Kappa 分布简单介绍</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/30/nonlineardynamics1/"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://th.bing.com/th/id/R.02693e210dd0d676caabdf8b4be096ef?rik=kqdSE%2bLFfxDrgw&amp;riu=http%3a%2f%2fs.cmpedu.com%2fimages%2fupload%2f2019%2f4%2f8%2f1558375971928(LT800).jpg&amp;ehk=6nE8WBye5MTQblvmJTE3%2faR6fSghNCFyZ38y26H72ME%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">非线性动力学-概论</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">摸鱼🐟ing...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Advanced-Earth-electromagnetism-Homework-3"><span class="toc-number">1.</span> <span class="toc-text">Advanced Earth electromagnetism Homework-3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Methods-and-data"><span class="toc-number">1.1.</span> <span class="toc-text">Methods and data</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text"> </span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Results"><span class="toc-number">2.1.</span> <span class="toc-text">Results</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Global-model-from-inverse-Gauss-Coefficient"><span class="toc-number">2.2.</span> <span class="toc-text">Global model from inverse Gauss Coefficient</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Comparison-with-IGRF-13"><span class="toc-number">2.3.</span> <span class="toc-text">Comparison with IGRF-13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Discussion"><span class="toc-number">2.4.</span> <span class="toc-text">Discussion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Code"><span class="toc-number">2.5.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">2.6.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Tabris Trees Severus</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      true && mermaid.init()
    })
  }
}</script><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://hexo-comment-phi.vercel.app/',
      region: 'ap-shanghai'
    }, "window.location.pathname"))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'https://hexo-comment-phi.vercel.app/',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://hexo-comment-phi.vercel.app/',
        region: 'ap-shanghai',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/1f64a5e9.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: '1f64a5e9',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-166333226-1', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>